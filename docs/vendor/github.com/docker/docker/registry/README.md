<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# registry

```go
import "github.com/docker/docker/registry"
```

Package registry contains client primitives to interact with a remote Docker registry.

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func CertsDir() string](<#func-certsdir>)
- [func ConvertToHostname(url string) string](<#func-converttohostname>)
- [func GetAuthConfigKey(index *registry.IndexInfo) string](<#func-getauthconfigkey>)
- [func Headers(userAgent string, metaHeaders http.Header) []transport.RequestModifier](<#func-headers>)
- [func HostCertsDir(hostname string) string](<#func-hostcertsdir>)
- [func NewStaticCredentialStore(auth *types.AuthConfig) auth.CredentialStore](<#func-newstaticcredentialstore>)
- [func ParseSearchIndexInfo(reposName string) (*registry.IndexInfo, error)](<#func-parsesearchindexinfo>)
- [func PingV2Registry(endpoint *url.URL, transport http.RoundTripper) (challenge.Manager, error)](<#func-pingv2registry>)
- [func ReadCertsDirectory(tlsConfig *tls.Config, directory string) error](<#func-readcertsdirectory>)
- [func ResolveAuthConfig(authConfigs map[string]types.AuthConfig, index *registry.IndexInfo) types.AuthConfig](<#func-resolveauthconfig>)
- [func SetCertsDir(path string)](<#func-setcertsdir>)
- [func ValidateIndexName(val string) (string, error)](<#func-validateindexname>)
- [func ValidateMirror(val string) (string, error)](<#func-validatemirror>)
- [type APIEndpoint](<#type-apiendpoint>)
- [type APIVersion](<#type-apiversion>)
  - [func (av APIVersion) String() string](<#func-apiversion-string>)
- [type PingResponseError](<#type-pingresponseerror>)
  - [func (err PingResponseError) Error() string](<#func-pingresponseerror-error>)
- [type RepositoryInfo](<#type-repositoryinfo>)
  - [func ParseRepositoryInfo(reposName reference.Named) (*RepositoryInfo, error)](<#func-parserepositoryinfo>)
- [type Service](<#type-service>)
  - [func NewService(options ServiceOptions) (Service, error)](<#func-newservice>)
- [type ServiceOptions](<#type-serviceoptions>)


## Constants

TODO\(thaJeztah\) both the "index.docker.io" and "registry\-1.docker.io" domains are here for historic reasons and backward\-compatibility. These domains are still supported by Docker Hub \(and will continue to be supported\), but there are new domains already in use, and plans to consolidate all legacy domains to new "canonical" domains. Once those domains are decided on, we should update these consts \(but making sure to preserve compatibility with existing installs, clients, and user configuration\).

```go
const (
    // DefaultNamespace is the default namespace
    DefaultNamespace = "docker.io"
    // DefaultRegistryHost is the hostname for the default (Docker Hub) registry
    // used for pushing and pulling images. This hostname is hard-coded to handle
    // the conversion from image references without registry name (e.g. "ubuntu",
    // or "ubuntu:latest"), as well as references using the "docker.io" domain
    // name, which is used as canonical reference for images on Docker Hub, but
    // does not match the domain-name of Docker Hub's registry.
    DefaultRegistryHost = "registry-1.docker.io"
    // IndexHostname is the index hostname, used for authentication and image search.
    IndexHostname = "index.docker.io"
    // IndexServer is used for user auth and image search
    IndexServer = "https://" + IndexHostname + "/v1/"
    // IndexName is the name of the index
    IndexName = "docker.io"
)
```

AuthClientID is used the ClientID used for the token server

```go
const AuthClientID = "docker"
```

## Variables

```go
var (
    // DefaultV2Registry is the URI of the default (Docker Hub) registry.
    DefaultV2Registry = &url.URL{
        Scheme: "https",
        Host:   DefaultRegistryHost,
    }
)
```

## func CertsDir

```go
func CertsDir() string
```

CertsDir is the directory where certificates are stored.

## func ConvertToHostname

```go
func ConvertToHostname(url string) string
```

ConvertToHostname converts a registry url which has http|https prepended to just an hostname.

## func GetAuthConfigKey

```go
func GetAuthConfigKey(index *registry.IndexInfo) string
```

GetAuthConfigKey special\-cases using the full index address of the official index as the AuthConfig key, and uses the \(host\)name\[:port\] for private indexes.

## func Headers

```go
func Headers(userAgent string, metaHeaders http.Header) []transport.RequestModifier
```

Headers returns request modifiers with a User\-Agent and metaHeaders

## func HostCertsDir

```go
func HostCertsDir(hostname string) string
```

HostCertsDir returns the config directory for a specific host.

## func NewStaticCredentialStore

```go
func NewStaticCredentialStore(auth *types.AuthConfig) auth.CredentialStore
```

NewStaticCredentialStore returns a credential store which always returns the same credential values.

## func ParseSearchIndexInfo

```go
func ParseSearchIndexInfo(reposName string) (*registry.IndexInfo, error)
```

ParseSearchIndexInfo will use repository name to get back an indexInfo.

TODO\(thaJeztah\) this function is only used by the CLI, and used to get information of the registry \(to provide credentials if needed\). We should move this function \(or equivalent\) to the CLI, as it's doing too much just for that.

## func PingV2Registry

```go
func PingV2Registry(endpoint *url.URL, transport http.RoundTripper) (challenge.Manager, error)
```

PingV2Registry attempts to ping a v2 registry and on success return a challenge manager for the supported authentication types. If a response is received but cannot be interpreted, a PingResponseError will be returned.

## func ReadCertsDirectory

```go
func ReadCertsDirectory(tlsConfig *tls.Config, directory string) error
```

ReadCertsDirectory reads the directory for TLS certificates including roots and certificate pairs and updates the provided TLS configuration.

## func ResolveAuthConfig

```go
func ResolveAuthConfig(authConfigs map[string]types.AuthConfig, index *registry.IndexInfo) types.AuthConfig
```

ResolveAuthConfig matches an auth configuration to a server address or a URL

## func SetCertsDir

```go
func SetCertsDir(path string)
```

SetCertsDir allows the default certs directory to be changed. This function is used at daemon startup to set the correct location when running in rootless mode.

## func ValidateIndexName

```go
func ValidateIndexName(val string) (string, error)
```

ValidateIndexName validates an index name.

## func ValidateMirror

```go
func ValidateMirror(val string) (string, error)
```

ValidateMirror validates an HTTP\(S\) registry mirror

## type APIEndpoint

APIEndpoint represents a remote API endpoint

```go
type APIEndpoint struct {
    Mirror                         bool
    URL                            *url.URL
    Version                        APIVersion
    AllowNondistributableArtifacts bool
    Official                       bool
    TrimHostname                   bool
    TLSConfig                      *tls.Config
}
```

## type APIVersion

APIVersion is an integral representation of an API version \(presently either 1 or 2\)

```go
type APIVersion int
```

API Version identifiers.

```go
const (
    APIVersion1 APIVersion = 1
    APIVersion2 APIVersion = 2
)
```

### func \(APIVersion\) String

```go
func (av APIVersion) String() string
```

## type PingResponseError

PingResponseError is used when the response from a ping was received but invalid.

```go
type PingResponseError struct {
    Err error
}
```

### func \(PingResponseError\) Error

```go
func (err PingResponseError) Error() string
```

## type RepositoryInfo

RepositoryInfo describes a repository

```go
type RepositoryInfo struct {
    Name reference.Named
    // Index points to registry information
    Index *registry.IndexInfo
    // Official indicates whether the repository is considered official.
    // If the registry is official, and the normalized name does not
    // contain a '/' (e.g. "foo"), then it is considered an official repo.
    Official bool
    // Class represents the class of the repository, such as "plugin"
    // or "image".
    Class string
}
```

### func ParseRepositoryInfo

```go
func ParseRepositoryInfo(reposName reference.Named) (*RepositoryInfo, error)
```

ParseRepositoryInfo performs the breakdown of a repository name into a RepositoryInfo, but lacks registry configuration.

## type Service

Service is the interface defining what a registry service should implement.

```go
type Service interface {
    Auth(ctx context.Context, authConfig *types.AuthConfig, userAgent string) (status, token string, err error)
    LookupPullEndpoints(hostname string) (endpoints []APIEndpoint, err error)
    LookupPushEndpoints(hostname string) (endpoints []APIEndpoint, err error)
    ResolveRepository(name reference.Named) (*RepositoryInfo, error)
    Search(ctx context.Context, term string, limit int, authConfig *types.AuthConfig, userAgent string, headers map[string][]string) (*registry.SearchResults, error)
    ServiceConfig() *registry.ServiceConfig
    LoadAllowNondistributableArtifacts([]string) error
    LoadMirrors([]string) error
    LoadInsecureRegistries([]string) error
}
```

### func NewService

```go
func NewService(options ServiceOptions) (Service, error)
```

NewService returns a new instance of defaultService ready to be installed into an engine.

## type ServiceOptions

ServiceOptions holds command line options.

```go
type ServiceOptions struct {
    AllowNondistributableArtifacts []string `json:"allow-nondistributable-artifacts,omitempty"`
    Mirrors                        []string `json:"registry-mirrors,omitempty"`
    InsecureRegistries             []string `json:"insecure-registries,omitempty"`
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
