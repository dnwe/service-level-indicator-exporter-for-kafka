<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# idtools

```go
import "github.com/docker/docker/pkg/idtools"
```

## Index

- [func AddNamespaceRangesUser(name string) (int, int, error)](<#func-addnamespacerangesuser>)
- [func CanAccess(path string, pair Identity) bool](<#func-canaccess>)
- [func GetRootUIDGID(uidMap, gidMap []IDMap) (int, int, error)](<#func-getrootuidgid>)
- [func LookupGID(gid int) (user.Group, error)](<#func-lookupgid>)
- [func LookupGroup(name string) (user.Group, error)](<#func-lookupgroup>)
- [func LookupUID(uid int) (user.User, error)](<#func-lookupuid>)
- [func LookupUser(name string) (user.User, error)](<#func-lookupuser>)
- [func MkdirAllAndChown(path string, mode os.FileMode, owner Identity) error](<#func-mkdirallandchown>)
- [func MkdirAllAndChownNew(path string, mode os.FileMode, owner Identity) error](<#func-mkdirallandchownnew>)
- [func MkdirAndChown(path string, mode os.FileMode, owner Identity) error](<#func-mkdirandchown>)
- [type IDMap](<#type-idmap>)
- [type Identity](<#type-identity>)
  - [func CurrentIdentity() Identity](<#func-currentidentity>)
  - [func (id Identity) Chown(name string) error](<#func-identity-chown>)
- [type IdentityMapping](<#type-identitymapping>)
  - [func LoadIdentityMapping(name string) (IdentityMapping, error)](<#func-loadidentitymapping>)
  - [func NewIdentityMapping(name string) (*IdentityMapping, error)](<#func-newidentitymapping>)
  - [func (i IdentityMapping) Empty() bool](<#func-identitymapping-empty>)
  - [func (i IdentityMapping) GIDs() []IDMap](<#func-identitymapping-gids>)
  - [func (i IdentityMapping) RootPair() Identity](<#func-identitymapping-rootpair>)
  - [func (i IdentityMapping) ToContainer(pair Identity) (int, int, error)](<#func-identitymapping-tocontainer>)
  - [func (i IdentityMapping) ToHost(pair Identity) (Identity, error)](<#func-identitymapping-tohost>)
  - [func (i IdentityMapping) UIDs() []IDMap](<#func-identitymapping-uids>)


## func AddNamespaceRangesUser

```go
func AddNamespaceRangesUser(name string) (int, int, error)
```

AddNamespaceRangesUser takes a name and finds an unused uid, gid pair and calls the appropriate helper function to add the group and then the user to the group in /etc/group and /etc/passwd respectively.

## func CanAccess

```go
func CanAccess(path string, pair Identity) bool
```

CanAccess takes a valid \(existing\) directory and a uid, gid pair and determines if that uid, gid pair has access \(execute bit\) to the directory

## func GetRootUIDGID

```go
func GetRootUIDGID(uidMap, gidMap []IDMap) (int, int, error)
```

GetRootUIDGID retrieves the remapped root uid/gid pair from the set of maps. If the maps are empty, then the root uid/gid will default to "real" 0/0

## func LookupGID

```go
func LookupGID(gid int) (user.Group, error)
```

LookupGID uses traditional local system files lookup \(from libcontainer/user\) on a group ID, followed by a call to \`getent\` for supporting host configured non\-files passwd and group dbs

## func LookupGroup

```go
func LookupGroup(name string) (user.Group, error)
```

LookupGroup uses traditional local system files lookup \(from libcontainer/user\) on a group name, followed by a call to \`getent\` for supporting host configured non\-files passwd and group dbs

## func LookupUID

```go
func LookupUID(uid int) (user.User, error)
```

LookupUID uses traditional local system files lookup \(from libcontainer/user\) on a uid, followed by a call to \`getent\` for supporting host configured non\-files passwd and group dbs

## func LookupUser

```go
func LookupUser(name string) (user.User, error)
```

LookupUser uses traditional local system files lookup \(from libcontainer/user\) on a username, followed by a call to \`getent\` for supporting host configured non\-files passwd and group dbs

## func MkdirAllAndChown

```go
func MkdirAllAndChown(path string, mode os.FileMode, owner Identity) error
```

MkdirAllAndChown creates a directory \(include any along the path\) and then modifies ownership to the requested uid/gid.  If the directory already exists, this function will still change ownership and permissions.

## func MkdirAllAndChownNew

```go
func MkdirAllAndChownNew(path string, mode os.FileMode, owner Identity) error
```

MkdirAllAndChownNew creates a directory \(include any along the path\) and then modifies ownership ONLY of newly created directories to the requested uid/gid. If the directories along the path exist, no change of ownership or permissions will be performed

## func MkdirAndChown

```go
func MkdirAndChown(path string, mode os.FileMode, owner Identity) error
```

MkdirAndChown creates a directory and then modifies ownership to the requested uid/gid. If the directory already exists, this function still changes ownership and permissions. Note that unlike os.Mkdir\(\), this function does not return IsExist error in case path already exists.

## type IDMap

IDMap contains a single entry for user namespace range remapping. An array of IDMap entries represents the structure that will be provided to the Linux kernel for creating a user namespace.

```go
type IDMap struct {
    ContainerID int `json:"container_id"`
    HostID      int `json:"host_id"`
    Size        int `json:"size"`
}
```

## type Identity

Identity is either a UID and GID pair or a SID \(but not both\)

```go
type Identity struct {
    UID int
    GID int
    SID string
}
```

### func CurrentIdentity

```go
func CurrentIdentity() Identity
```

CurrentIdentity returns the identity of the current process

### func \(Identity\) Chown

```go
func (id Identity) Chown(name string) error
```

Chown changes the numeric uid and gid of the named file to id.UID and id.GID.

## type IdentityMapping

IdentityMapping contains a mappings of UIDs and GIDs. The zero value represents an empty mapping.

```go
type IdentityMapping struct {
    UIDMaps []IDMap `json:"UIDMaps"`
    GIDMaps []IDMap `json:"GIDMaps"`
}
```

### func LoadIdentityMapping

```go
func LoadIdentityMapping(name string) (IdentityMapping, error)
```

LoadIdentityMapping takes a requested username and using the data from /etc/sub\{uid,gid\} ranges, creates the proper uid and gid remapping ranges for that user/group pair

### func NewIdentityMapping

```go
func NewIdentityMapping(name string) (*IdentityMapping, error)
```

NewIdentityMapping takes a requested username and using the data from /etc/sub\{uid,gid\} ranges, creates the proper uid and gid remapping ranges for that user/group pair

Deprecated: Use LoadIdentityMapping.

### func \(IdentityMapping\) Empty

```go
func (i IdentityMapping) Empty() bool
```

Empty returns true if there are no id mappings

### func \(IdentityMapping\) GIDs

```go
func (i IdentityMapping) GIDs() []IDMap
```

GIDs returns the mapping for GID.

Deprecated: reference the GIDMaps field directly.

### func \(IdentityMapping\) RootPair

```go
func (i IdentityMapping) RootPair() Identity
```

RootPair returns a uid and gid pair for the root user. The error is ignored because a root user always exists, and the defaults are correct when the uid and gid maps are empty.

### func \(IdentityMapping\) ToContainer

```go
func (i IdentityMapping) ToContainer(pair Identity) (int, int, error)
```

ToContainer returns the container UID and GID for the host uid and gid

### func \(IdentityMapping\) ToHost

```go
func (i IdentityMapping) ToHost(pair Identity) (Identity, error)
```

ToHost returns the host UID and GID for the container uid, gid. Remapping is only performed if the ids aren't already the remapped root ids

### func \(IdentityMapping\) UIDs

```go
func (i IdentityMapping) UIDs() []IDMap
```

UIDs returns the mapping for UID.

Deprecated: reference the UIDMaps field directly.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
