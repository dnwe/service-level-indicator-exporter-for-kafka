<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# store

```go
import "github.com/vmware/service-level-indicator-exporter-for-kafka/vendor/github.com/docker/cli/cli/context/store"
```

Package store provides a generic way to store credentials to connect to virtually any kind of remote system. The term \`context\` comes from the similar feature in Kubernetes kubectl config files.

Conceptually, a context is a set of metadata and TLS data, that can be used to connect to various endpoints of a remote system. TLS data and metadata are stored separately, so that in the future, we will be able to store sensitive information in a more secure way, depending on the os we are running on \(e.g.: on Windows we could use the user Certificate Store, on macOS the user Keychain...\).

Current implementation is purely file based with the following structure:

```
${CONTEXT_ROOT}
  meta/
    <context id>/meta.json: contains context medata (key/value pairs) as
                            well as a list of endpoints (themselves containing
                            key/value pair metadata).
  tls/
    <context id>/endpoint1/: directory containing TLS data for the endpoint1
                             in the corresponding context.
```

The context store itself has absolutely no knowledge about what a docker endpoint should contain in term of metadata or TLS config. Client code is responsible for generating and parsing endpoint metadata and TLS files. The multi\-endpoints approach of this package allows to combine many different endpoints in the same "context".

Context IDs are actually SHA256 hashes of the context name, and are there only to avoid dealing with special characters in context names.

## Index

- [func Export(name string, s Reader) io.ReadCloser](<#func-export>)
- [func Import(name string, s Writer, reader io.Reader) error](<#func-import>)
- [func IsErrContextDoesNotExist(err error) bool](<#func-iserrcontextdoesnotexist>)
- [func IsErrTLSDataDoesNotExist(err error) bool](<#func-iserrtlsdatadoesnotexist>)
- [func Names(s Lister) ([]string, error)](<#func-names>)
- [func ValidateContextName(name string) error](<#func-validatecontextname>)
- [type Config](<#type-config>)
  - [func NewConfig(contextType TypeGetter, endpoints ...NamedTypeGetter) Config](<#func-newconfig>)
  - [func (c Config) ForeachEndpointType(cb func(string, TypeGetter) error) error](<#func-config-foreachendpointtype>)
  - [func (c Config) SetEndpoint(name string, getter TypeGetter)](<#func-config-setendpoint>)
- [type ContextStore](<#type-contextstore>)
  - [func New(dir string, cfg Config) *ContextStore](<#func-new>)
  - [func (s *ContextStore) CreateOrUpdate(meta Metadata) error](<#func-contextstore-createorupdate>)
  - [func (s *ContextStore) GetMetadata(name string) (Metadata, error)](<#func-contextstore-getmetadata>)
  - [func (s *ContextStore) GetStorageInfo(contextName string) StorageInfo](<#func-contextstore-getstorageinfo>)
  - [func (s *ContextStore) GetTLSData(contextName, endpointName, fileName string) ([]byte, error)](<#func-contextstore-gettlsdata>)
  - [func (s *ContextStore) List() ([]Metadata, error)](<#func-contextstore-list>)
  - [func (s *ContextStore) ListTLSFiles(name string) (map[string]EndpointFiles, error)](<#func-contextstore-listtlsfiles>)
  - [func (s *ContextStore) Remove(name string) error](<#func-contextstore-remove>)
  - [func (s *ContextStore) ResetEndpointTLSMaterial(contextName string, endpointName string, data *EndpointTLSData) error](<#func-contextstore-resetendpointtlsmaterial>)
  - [func (s *ContextStore) ResetTLSMaterial(name string, data *ContextTLSData) error](<#func-contextstore-resettlsmaterial>)
- [type ContextTLSData](<#type-contexttlsdata>)
- [type EndpointFiles](<#type-endpointfiles>)
- [type EndpointTLSData](<#type-endpointtlsdata>)
- [type LimitedReader](<#type-limitedreader>)
  - [func (l *LimitedReader) Read(p []byte) (n int, err error)](<#func-limitedreader-read>)
- [type Lister](<#type-lister>)
- [type Metadata](<#type-metadata>)
- [type NamedTypeGetter](<#type-namedtypegetter>)
  - [func EndpointTypeGetter(name string, getter TypeGetter) NamedTypeGetter](<#func-endpointtypegetter>)
- [type Reader](<#type-reader>)
- [type ReaderLister](<#type-readerlister>)
- [type ReaderWriter](<#type-readerwriter>)
- [type StorageInfo](<#type-storageinfo>)
- [type StorageInfoProvider](<#type-storageinfoprovider>)
- [type Store](<#type-store>)
- [type TypeGetter](<#type-typegetter>)
- [type Writer](<#type-writer>)


## func Export

```go
func Export(name string, s Reader) io.ReadCloser
```

Export exports an existing namespace into an opaque data stream This stream is actually a tarball containing context metadata and TLS materials, but it does not map 1:1 the layout of the context store \(don't try to restore it manually without calling store.Import\)

## func Import

```go
func Import(name string, s Writer, reader io.Reader) error
```

Import imports an exported context into a store

## func IsErrContextDoesNotExist

```go
func IsErrContextDoesNotExist(err error) bool
```

IsErrContextDoesNotExist checks if the given error is a "context does not exist" condition.

Deprecated: use github.com/docker/docker/errdefs.IsNotFound\(\)

## func IsErrTLSDataDoesNotExist

```go
func IsErrTLSDataDoesNotExist(err error) bool
```

### IsErrTLSDataDoesNotExist checks if the given error is a "context does not exist" condition

Deprecated: use github.com/docker/docker/errdefs.IsNotFound\(\)

## func Names

```go
func Names(s Lister) ([]string, error)
```

Names return Metadata names for a Lister

## func ValidateContextName

```go
func ValidateContextName(name string) error
```

ValidateContextName checks a context name is valid.

## type Config

Config is used to configure the metadata marshaler of the context ContextStore

```go
type Config struct {
    // contains filtered or unexported fields
}
```

### func NewConfig

```go
func NewConfig(contextType TypeGetter, endpoints ...NamedTypeGetter) Config
```

NewConfig creates a config object

### func \(Config\) ForeachEndpointType

```go
func (c Config) ForeachEndpointType(cb func(string, TypeGetter) error) error
```

ForeachEndpointType calls cb on every endpoint type registered with the Config

### func \(Config\) SetEndpoint

```go
func (c Config) SetEndpoint(name string, getter TypeGetter)
```

SetEndpoint set an endpoint typing information

## type ContextStore

ContextStore implements Store.

```go
type ContextStore struct {
    // contains filtered or unexported fields
}
```

### func New

```go
func New(dir string, cfg Config) *ContextStore
```

New creates a store from a given directory. If the directory does not exist or is empty, initialize it

### func \(\*ContextStore\) CreateOrUpdate

```go
func (s *ContextStore) CreateOrUpdate(meta Metadata) error
```

CreateOrUpdate creates or updates metadata for the context.

### func \(\*ContextStore\) GetMetadata

```go
func (s *ContextStore) GetMetadata(name string) (Metadata, error)
```

GetMetadata returns the metadata for the context with the given name. It returns an errdefs.ErrNotFound if the context was not found.

### func \(\*ContextStore\) GetStorageInfo

```go
func (s *ContextStore) GetStorageInfo(contextName string) StorageInfo
```

GetStorageInfo returns the paths where the Metadata and TLS data are stored for the context.

### func \(\*ContextStore\) GetTLSData

```go
func (s *ContextStore) GetTLSData(contextName, endpointName, fileName string) ([]byte, error)
```

GetTLSData reads, and returns the content of the given fileName for an endpoint. It returns an errdefs.ErrNotFound if the file was not found.

### func \(\*ContextStore\) List

```go
func (s *ContextStore) List() ([]Metadata, error)
```

List return all contexts.

### func \(\*ContextStore\) ListTLSFiles

```go
func (s *ContextStore) ListTLSFiles(name string) (map[string]EndpointFiles, error)
```

ListTLSFiles returns the list of TLS files present for each endpoint in the context.

### func \(\*ContextStore\) Remove

```go
func (s *ContextStore) Remove(name string) error
```

Remove deletes the context with the given name, if found.

### func \(\*ContextStore\) ResetEndpointTLSMaterial

```go
func (s *ContextStore) ResetEndpointTLSMaterial(contextName string, endpointName string, data *EndpointTLSData) error
```

ResetEndpointTLSMaterial removes TLS data for the given context and endpoint, and replaces it with the new data.

### func \(\*ContextStore\) ResetTLSMaterial

```go
func (s *ContextStore) ResetTLSMaterial(name string, data *ContextTLSData) error
```

ResetTLSMaterial removes TLS data for all endpoints in the context and replaces it with the new data.

## type ContextTLSData

ContextTLSData represents tls data for a whole context

```go
type ContextTLSData struct {
    Endpoints map[string]EndpointTLSData
}
```

## type EndpointFiles

EndpointFiles is a slice of strings representing file names

```go
type EndpointFiles []string
```

## type EndpointTLSData

EndpointTLSData represents tls data for a given endpoint

```go
type EndpointTLSData struct {
    Files map[string][]byte
}
```

## type LimitedReader

LimitedReader is a fork of io.LimitedReader to override Read.

```go
type LimitedReader struct {
    R   io.Reader
    N   int64 // max bytes remaining
}
```

### func \(\*LimitedReader\) Read

```go
func (l *LimitedReader) Read(p []byte) (n int, err error)
```

Read is a fork of io.LimitedReader.Read that returns an error when limit exceeded.

## type Lister

Lister provides listing of contexts

```go
type Lister interface {
    List() ([]Metadata, error)
}
```

## type Metadata

Metadata contains metadata about a context and its endpoints

```go
type Metadata struct {
    Name      string                 `json:",omitempty"`
    Metadata  interface{}            `json:",omitempty"`
    Endpoints map[string]interface{} `json:",omitempty"`
}
```

## type NamedTypeGetter

NamedTypeGetter is a TypeGetter associated with a name

```go
type NamedTypeGetter struct {
    // contains filtered or unexported fields
}
```

### func EndpointTypeGetter

```go
func EndpointTypeGetter(name string, getter TypeGetter) NamedTypeGetter
```

EndpointTypeGetter returns a NamedTypeGetter with the spcecified name and getter

## type Reader

Reader provides read\-only \(without list\) access to context data

```go
type Reader interface {
    GetMetadata(name string) (Metadata, error)
    ListTLSFiles(name string) (map[string]EndpointFiles, error)
    GetTLSData(contextName, endpointName, fileName string) ([]byte, error)
}
```

## type ReaderLister

ReaderLister combines Reader and Lister interfaces

```go
type ReaderLister interface {
    Reader
    Lister
}
```

## type ReaderWriter

ReaderWriter combines Reader and Writer interfaces

```go
type ReaderWriter interface {
    Reader
    Writer
}
```

## type StorageInfo

StorageInfo contains data about where a given context is stored

```go
type StorageInfo struct {
    MetadataPath string
    TLSPath      string
}
```

## type StorageInfoProvider

StorageInfoProvider provides more information about storage details of contexts

```go
type StorageInfoProvider interface {
    GetStorageInfo(contextName string) StorageInfo
}
```

## type Store

Store provides a context store for easily remembering endpoints configuration

```go
type Store interface {
    Reader
    Lister
    Writer
    StorageInfoProvider
}
```

## type TypeGetter

TypeGetter is a func used to determine the concrete type of a context or endpoint metadata by returning a pointer to an instance of the object eg: for a context of type DockerContext, the corresponding TypeGetter should return new\(DockerContext\)

```go
type TypeGetter func() interface{}
```

## type Writer

Writer provides write access to context data

```go
type Writer interface {
    CreateOrUpdate(meta Metadata) error
    Remove(name string) error
    ResetTLSMaterial(name string, data *ContextTLSData) error
    ResetEndpointTLSMaterial(contextName string, endpointName string, data *EndpointTLSData) error
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
