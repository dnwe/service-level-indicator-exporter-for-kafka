<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# trustmanager

```go
import "github.com/vmware/service-level-indicator-exporter-for-kafka/vendor/github.com/theupdateframework/notary/trustmanager"
```

## Index

- [func ExportKeys(to io.Writer, s Exporter, from string) error](<#func-exportkeys>)
- [func ExportKeysByGUN(to io.Writer, s Exporter, gun string) error](<#func-exportkeysbygun>)
- [func ExportKeysByID(to io.Writer, s Exporter, ids []string) error](<#func-exportkeysbyid>)
- [func GetPasswdDecryptBytes(passphraseRetriever notary.PassRetriever, pemBytes []byte, name, alias string) (data.PrivateKey, string, error)](<#func-getpasswddecryptbytes>)
- [func ImportKeys(from io.Reader, to []Importer, fallbackRole string, fallbackGUN string, passRet notary.PassRetriever) error](<#func-importkeys>)
- [type ErrAttemptsExceeded](<#type-errattemptsexceeded>)
  - [func (err ErrAttemptsExceeded) Error() string](<#func-errattemptsexceeded-error>)
- [type ErrKeyNotFound](<#type-errkeynotfound>)
  - [func (err ErrKeyNotFound) Error() string](<#func-errkeynotfound-error>)
- [type ErrPasswordInvalid](<#type-errpasswordinvalid>)
  - [func (err ErrPasswordInvalid) Error() string](<#func-errpasswordinvalid-error>)
- [type Exporter](<#type-exporter>)
- [type GenericKeyStore](<#type-generickeystore>)
  - [func NewGenericKeyStore(s Storage, p notary.PassRetriever) *GenericKeyStore](<#func-newgenerickeystore>)
  - [func NewKeyFileStore(baseDir string, p notary.PassRetriever) (*GenericKeyStore, error)](<#func-newkeyfilestore>)
  - [func NewKeyMemoryStore(p notary.PassRetriever) *GenericKeyStore](<#func-newkeymemorystore>)
  - [func (s *GenericKeyStore) AddKey(keyInfo KeyInfo, privKey data.PrivateKey) error](<#func-generickeystore-addkey>)
  - [func (s *GenericKeyStore) GetKey(keyID string) (data.PrivateKey, data.RoleName, error)](<#func-generickeystore-getkey>)
  - [func (s *GenericKeyStore) GetKeyInfo(keyID string) (KeyInfo, error)](<#func-generickeystore-getkeyinfo>)
  - [func (s *GenericKeyStore) ListKeys() map[string]KeyInfo](<#func-generickeystore-listkeys>)
  - [func (s *GenericKeyStore) Name() string](<#func-generickeystore-name>)
  - [func (s *GenericKeyStore) RemoveKey(keyID string) error](<#func-generickeystore-removekey>)
- [type Importer](<#type-importer>)
- [type KeyInfo](<#type-keyinfo>)
  - [func KeyInfoFromPEM(pemBytes []byte, filename string) (string, KeyInfo, error)](<#func-keyinfofrompem>)
- [type KeyStore](<#type-keystore>)
- [type Storage](<#type-storage>)


## func ExportKeys

```go
func ExportKeys(to io.Writer, s Exporter, from string) error
```

ExportKeys copies a key from the store to the io.Writer

## func ExportKeysByGUN

```go
func ExportKeysByGUN(to io.Writer, s Exporter, gun string) error
```

ExportKeysByGUN exports all keys filtered to a GUN

## func ExportKeysByID

```go
func ExportKeysByID(to io.Writer, s Exporter, ids []string) error
```

ExportKeysByID exports all keys matching the given ID

## func GetPasswdDecryptBytes

```go
func GetPasswdDecryptBytes(passphraseRetriever notary.PassRetriever, pemBytes []byte, name, alias string) (data.PrivateKey, string, error)
```

GetPasswdDecryptBytes gets the password to decrypt the given pem bytes. Returns the password and private key

## func ImportKeys

```go
func ImportKeys(from io.Reader, to []Importer, fallbackRole string, fallbackGUN string, passRet notary.PassRetriever) error
```

ImportKeys expects an io.Reader containing one or more PEM blocks. It reads PEM blocks one at a time until pem.Decode returns a nil block. Each block is written to the subpath indicated in the "path" PEM header. If the file already exists, the file is truncated. Multiple adjacent PEMs with the same "path" header are appended together.

## type ErrAttemptsExceeded

ErrAttemptsExceeded is returned when too many attempts have been made to decrypt a key

```go
type ErrAttemptsExceeded struct{}
```

### func \(ErrAttemptsExceeded\) Error

```go
func (err ErrAttemptsExceeded) Error() string
```

ErrAttemptsExceeded is returned when too many attempts have been made to decrypt a key

## type ErrKeyNotFound

ErrKeyNotFound is returned when the keystore fails to retrieve a specific key.

```go
type ErrKeyNotFound struct {
    KeyID string
}
```

### func \(ErrKeyNotFound\) Error

```go
func (err ErrKeyNotFound) Error() string
```

ErrKeyNotFound is returned when the keystore fails to retrieve a specific key.

## type ErrPasswordInvalid

ErrPasswordInvalid is returned when signing fails. It could also mean the signing key file was corrupted, but we have no way to distinguish.

```go
type ErrPasswordInvalid struct{}
```

### func \(ErrPasswordInvalid\) Error

```go
func (err ErrPasswordInvalid) Error() string
```

ErrPasswordInvalid is returned when signing fails. It could also mean the signing key file was corrupted, but we have no way to distinguish.

## type Exporter

Exporter is a simple interface for the two functions we need from the Storage interface

```go
type Exporter interface {
    Get(string) ([]byte, error)
    ListFiles() []string
}
```

## type GenericKeyStore

GenericKeyStore is a wrapper for Storage instances that provides translation between the \[\]byte form and Public/PrivateKey objects

```go
type GenericKeyStore struct {
    sync.Mutex
    notary.PassRetriever
    // contains filtered or unexported fields
}
```

### func NewGenericKeyStore

```go
func NewGenericKeyStore(s Storage, p notary.PassRetriever) *GenericKeyStore
```

NewGenericKeyStore creates a GenericKeyStore wrapping the provided Storage instance, using the PassRetriever to enc/decrypt keys

### func NewKeyFileStore

```go
func NewKeyFileStore(baseDir string, p notary.PassRetriever) (*GenericKeyStore, error)
```

NewKeyFileStore returns a new KeyFileStore creating a private directory to hold the keys.

### func NewKeyMemoryStore

```go
func NewKeyMemoryStore(p notary.PassRetriever) *GenericKeyStore
```

NewKeyMemoryStore returns a new KeyMemoryStore which holds keys in memory

### func \(\*GenericKeyStore\) AddKey

```go
func (s *GenericKeyStore) AddKey(keyInfo KeyInfo, privKey data.PrivateKey) error
```

AddKey stores the contents of a PEM\-encoded private key as a PEM block

### func \(\*GenericKeyStore\) GetKey

```go
func (s *GenericKeyStore) GetKey(keyID string) (data.PrivateKey, data.RoleName, error)
```

GetKey returns the PrivateKey given a KeyID

### func \(\*GenericKeyStore\) GetKeyInfo

```go
func (s *GenericKeyStore) GetKeyInfo(keyID string) (KeyInfo, error)
```

GetKeyInfo returns the corresponding gun and role key info for a keyID

### func \(\*GenericKeyStore\) ListKeys

```go
func (s *GenericKeyStore) ListKeys() map[string]KeyInfo
```

ListKeys returns a list of unique PublicKeys present on the KeyFileStore, by returning a copy of the keyInfoMap

### func \(\*GenericKeyStore\) Name

```go
func (s *GenericKeyStore) Name() string
```

Name returns a user friendly name for the location this store keeps its data

### func \(\*GenericKeyStore\) RemoveKey

```go
func (s *GenericKeyStore) RemoveKey(keyID string) error
```

RemoveKey removes the key from the keyfilestore

## type Importer

Importer is a simple interface for the one function we need from the Storage interface

```go
type Importer interface {
    Set(string, []byte) error
}
```

## type KeyInfo

KeyInfo stores the role and gun for a corresponding private key ID It is assumed that each private key ID is unique

```go
type KeyInfo struct {
    Gun  data.GUN
    Role data.RoleName
}
```

### func KeyInfoFromPEM

```go
func KeyInfoFromPEM(pemBytes []byte, filename string) (string, KeyInfo, error)
```

KeyInfoFromPEM attempts to get a keyID and KeyInfo from the filename and PEM bytes of a key

## type KeyStore

KeyStore is a generic interface for private key storage

```go
type KeyStore interface {
    // AddKey adds a key to the KeyStore, and if the key already exists,
    // succeeds.  Otherwise, returns an error if it cannot add.
    AddKey(keyInfo KeyInfo, privKey data.PrivateKey) error
    // Should fail with ErrKeyNotFound if the keystore is operating normally
    // and knows that it does not store the requested key.
    GetKey(keyID string) (data.PrivateKey, data.RoleName, error)
    GetKeyInfo(keyID string) (KeyInfo, error)
    ListKeys() map[string]KeyInfo
    RemoveKey(keyID string) error
    Name() string
}
```

## type Storage

Storage implements the bare bones primitives \(no hierarchy\)

```go
type Storage interface {
    // Add writes a file to the specified location, returning an error if this
    // is not possible (reasons may include permissions errors). The path is cleaned
    // before being made absolute against the store's base dir.
    Set(fileName string, data []byte) error

    // Remove deletes a file from the store relative to the store's base directory.
    // The path is cleaned before being made absolute to ensure no path traversal
    // outside the base directory is possible.
    Remove(fileName string) error

    // Get returns the file content found at fileName relative to the base directory
    // of the file store. The path is cleaned before being made absolute to ensure
    // path traversal outside the store is not possible. If the file is not found
    // an error to that effect is returned.
    Get(fileName string) ([]byte, error)

    // ListFiles returns a list of paths relative to the base directory of the
    // filestore. Any of these paths must be retrievable via the
    // Storage.Get method.
    ListFiles() []string

    // Location returns a human readable name indicating where the implementer
    // is storing keys
    Location() string
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
