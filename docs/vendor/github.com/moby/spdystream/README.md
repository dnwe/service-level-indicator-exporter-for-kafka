<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# spdystream

```go
import "github.com/vmware/service-level-indicator-exporter-for-kafka/vendor/github.com/moby/spdystream"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func MirrorStreamHandler(stream *Stream)](<#func-mirrorstreamhandler>)
- [func NoOpStreamHandler(stream *Stream)](<#func-noopstreamhandler>)
- [type AuthHandler](<#type-authhandler>)
- [type Connection](<#type-connection>)
  - [func NewConnection(conn net.Conn, server bool) (*Connection, error)](<#func-newconnection>)
  - [func (s *Connection) Close() error](<#func-connection-close>)
  - [func (s *Connection) CloseChan() <-chan bool](<#func-connection-closechan>)
  - [func (s *Connection) CloseWait() error](<#func-connection-closewait>)
  - [func (s *Connection) CreateStream(headers http.Header, parent *Stream, fin bool) (*Stream, error)](<#func-connection-createstream>)
  - [func (s *Connection) FindStream(streamId uint32) *Stream](<#func-connection-findstream>)
  - [func (s *Connection) NotifyClose(c chan<- *Stream, timeout time.Duration)](<#func-connection-notifyclose>)
  - [func (s *Connection) PeekNextStreamId() spdy.StreamId](<#func-connection-peeknextstreamid>)
  - [func (s *Connection) Ping() (time.Duration, error)](<#func-connection-ping>)
  - [func (s *Connection) Serve(newHandler StreamHandler)](<#func-connection-serve>)
  - [func (s *Connection) SetCloseTimeout(timeout time.Duration)](<#func-connection-setclosetimeout>)
  - [func (s *Connection) SetIdleTimeout(timeout time.Duration)](<#func-connection-setidletimeout>)
  - [func (s *Connection) Wait(waitTimeout time.Duration) error](<#func-connection-wait>)
- [type PriorityFrameQueue](<#type-priorityframequeue>)
  - [func NewPriorityFrameQueue(size int) *PriorityFrameQueue](<#func-newpriorityframequeue>)
  - [func (q *PriorityFrameQueue) Drain()](<#func-priorityframequeue-drain>)
  - [func (q *PriorityFrameQueue) Pop() spdy.Frame](<#func-priorityframequeue-pop>)
  - [func (q *PriorityFrameQueue) Push(frame spdy.Frame, priority uint8)](<#func-priorityframequeue-push>)
- [type Stream](<#type-stream>)
  - [func (s *Stream) Cancel() error](<#func-stream-cancel>)
  - [func (s *Stream) Close() error](<#func-stream-close>)
  - [func (s *Stream) CreateSubStream(headers http.Header, fin bool) (*Stream, error)](<#func-stream-createsubstream>)
  - [func (s *Stream) Headers() http.Header](<#func-stream-headers>)
  - [func (s *Stream) Identifier() uint32](<#func-stream-identifier>)
  - [func (s *Stream) IsFinished() bool](<#func-stream-isfinished>)
  - [func (s *Stream) LocalAddr() net.Addr](<#func-stream-localaddr>)
  - [func (s *Stream) Parent() *Stream](<#func-stream-parent>)
  - [func (s *Stream) Read(p []byte) (n int, err error)](<#func-stream-read>)
  - [func (s *Stream) ReadData() ([]byte, error)](<#func-stream-readdata>)
  - [func (s *Stream) ReceiveHeader() (http.Header, error)](<#func-stream-receiveheader>)
  - [func (s *Stream) Refuse() error](<#func-stream-refuse>)
  - [func (s *Stream) RemoteAddr() net.Addr](<#func-stream-remoteaddr>)
  - [func (s *Stream) Reset() error](<#func-stream-reset>)
  - [func (s *Stream) SendHeader(headers http.Header, fin bool) error](<#func-stream-sendheader>)
  - [func (s *Stream) SendReply(headers http.Header, fin bool) error](<#func-stream-sendreply>)
  - [func (s *Stream) SetDeadline(t time.Time) error](<#func-stream-setdeadline>)
  - [func (s *Stream) SetPriority(priority uint8)](<#func-stream-setpriority>)
  - [func (s *Stream) SetReadDeadline(t time.Time) error](<#func-stream-setreaddeadline>)
  - [func (s *Stream) SetWriteDeadline(t time.Time) error](<#func-stream-setwritedeadline>)
  - [func (s *Stream) String() string](<#func-stream-string>)
  - [func (s *Stream) Wait() error](<#func-stream-wait>)
  - [func (s *Stream) WaitTimeout(timeout time.Duration) error](<#func-stream-waittimeout>)
  - [func (s *Stream) Write(data []byte) (n int, err error)](<#func-stream-write>)
  - [func (s *Stream) WriteData(data []byte, fin bool) error](<#func-stream-writedata>)
- [type StreamHandler](<#type-streamhandler>)


## Constants

```go
const (
    FRAME_WORKERS = 5
    QUEUE_SIZE    = 50
)
```

## Variables

```go
var (
    ErrInvalidStreamId   = errors.New("Invalid stream id")
    ErrTimeout           = errors.New("Timeout occurred")
    ErrReset             = errors.New("Stream reset")
    ErrWriteClosedStream = errors.New("Write on closed stream")
)
```

```go
var (
    DEBUG = os.Getenv("DEBUG")
)
```

```go
var (
    ErrUnreadPartialData = errors.New("unread partial data")
)
```

## func MirrorStreamHandler

```go
func MirrorStreamHandler(stream *Stream)
```

MirrorStreamHandler mirrors all streams.

## func NoOpStreamHandler

```go
func NoOpStreamHandler(stream *Stream)
```

NoopStreamHandler does nothing when stream connects.

## type AuthHandler

```go
type AuthHandler func(header http.Header, slot uint8, parent uint32) bool
```

## type Connection

```go
type Connection struct {
    // contains filtered or unexported fields
}
```

### func NewConnection

```go
func NewConnection(conn net.Conn, server bool) (*Connection, error)
```

NewConnection creates a new spdy connection from an existing network connection.

### func \(\*Connection\) Close

```go
func (s *Connection) Close() error
```

Closes spdy connection by sending GoAway frame and initiating shutdown

### func \(\*Connection\) CloseChan

```go
func (s *Connection) CloseChan() <-chan bool
```

### func \(\*Connection\) CloseWait

```go
func (s *Connection) CloseWait() error
```

CloseWait closes the connection and waits for shutdown to finish.  Note the underlying network Connection is not closed until the end of shutdown.

### func \(\*Connection\) CreateStream

```go
func (s *Connection) CreateStream(headers http.Header, parent *Stream, fin bool) (*Stream, error)
```

CreateStream creates a new spdy stream using the parameters for creating the stream frame.  The stream frame will be sent upon calling this function, however this function does not wait for the reply frame.  If waiting for the reply is desired, use the stream Wait or WaitTimeout function on the stream returned by this function.

### func \(\*Connection\) FindStream

```go
func (s *Connection) FindStream(streamId uint32) *Stream
```

FindStream looks up the given stream id and either waits for the stream to be found or returns nil if the stream id is no longer valid.

### func \(\*Connection\) NotifyClose

```go
func (s *Connection) NotifyClose(c chan<- *Stream, timeout time.Duration)
```

NotifyClose registers a channel to be called when the remote peer inidicates connection closure.  The last stream to be received by the remote will be sent on the channel.  The notify timeout will determine the duration between go away received and the connection being closed.

### func \(\*Connection\) PeekNextStreamId

```go
func (s *Connection) PeekNextStreamId() spdy.StreamId
```

PeekNextStreamId returns the next sequential id and keeps the next id untouched

### func \(\*Connection\) Ping

```go
func (s *Connection) Ping() (time.Duration, error)
```

Ping sends a ping frame across the connection and returns the response time

### func \(\*Connection\) Serve

```go
func (s *Connection) Serve(newHandler StreamHandler)
```

Serve handles frames sent from the server, including reply frames which are needed to fully initiate connections.  Both clients and servers should call Serve in a separate goroutine before creating streams.

### func \(\*Connection\) SetCloseTimeout

```go
func (s *Connection) SetCloseTimeout(timeout time.Duration)
```

SetCloseTimeout sets the amount of time close will wait for streams to finish before terminating the underlying network connection.  Setting the timeout to 0 will cause close to wait forever, which is the default.

### func \(\*Connection\) SetIdleTimeout

```go
func (s *Connection) SetIdleTimeout(timeout time.Duration)
```

SetIdleTimeout sets the amount of time the connection may sit idle before it is forcefully terminated.

### func \(\*Connection\) Wait

```go
func (s *Connection) Wait(waitTimeout time.Duration) error
```

Wait waits for the connection to finish shutdown or for the wait timeout duration to expire.  This needs to be called either after Close has been called or the GOAWAYFRAME has been received.  If the wait timeout is 0, this function will block until shutdown finishes.  If wait is never called and a shutdown error occurs, that error will be logged as an unhandled error.

## type PriorityFrameQueue

```go
type PriorityFrameQueue struct {
    // contains filtered or unexported fields
}
```

### func NewPriorityFrameQueue

```go
func NewPriorityFrameQueue(size int) *PriorityFrameQueue
```

### func \(\*PriorityFrameQueue\) Drain

```go
func (q *PriorityFrameQueue) Drain()
```

### func \(\*PriorityFrameQueue\) Pop

```go
func (q *PriorityFrameQueue) Pop() spdy.Frame
```

### func \(\*PriorityFrameQueue\) Push

```go
func (q *PriorityFrameQueue) Push(frame spdy.Frame, priority uint8)
```

## type Stream

```go
type Stream struct {
    // contains filtered or unexported fields
}
```

### func \(\*Stream\) Cancel

```go
func (s *Stream) Cancel() error
```

Cancel sends a reset frame with the status canceled. This can be used at any time by the creator of the Stream to indicate the stream is no longer needed.

### func \(\*Stream\) Close

```go
func (s *Stream) Close() error
```

Close closes the stream by sending an empty data frame with the finish flag set, indicating this side is finished with the stream.

### func \(\*Stream\) CreateSubStream

```go
func (s *Stream) CreateSubStream(headers http.Header, fin bool) (*Stream, error)
```

CreateSubStream creates a stream using the current as the parent

### func \(\*Stream\) Headers

```go
func (s *Stream) Headers() http.Header
```

Headers returns the headers used to create the stream

### func \(\*Stream\) Identifier

```go
func (s *Stream) Identifier() uint32
```

Identifier returns a 32 bit identifier for the stream

### func \(\*Stream\) IsFinished

```go
func (s *Stream) IsFinished() bool
```

IsFinished returns whether the stream has finished sending data

### func \(\*Stream\) LocalAddr

```go
func (s *Stream) LocalAddr() net.Addr
```

### func \(\*Stream\) Parent

```go
func (s *Stream) Parent() *Stream
```

Parent returns the parent stream

### func \(\*Stream\) Read

```go
func (s *Stream) Read(p []byte) (n int, err error)
```

Read reads bytes from a stream, a single read will never get more than what is sent on a single data frame, but a multiple calls to read may get data from the same data frame.

### func \(\*Stream\) ReadData

```go
func (s *Stream) ReadData() ([]byte, error)
```

ReadData reads an entire data frame and returns the byte array from the data frame.  If there is unread data from the result of a Read call, this function will return an ErrUnreadPartialData.

### func \(\*Stream\) ReceiveHeader

```go
func (s *Stream) ReceiveHeader() (http.Header, error)
```

ReceiveHeader receives a header sent on the other side of the stream.  This function will block until a header is received or stream is closed.

### func \(\*Stream\) Refuse

```go
func (s *Stream) Refuse() error
```

Refuse sends a reset frame with the status refuse, only valid to be called once when handling a new stream.  This may be used to indicate that a stream is not allowed when http status codes are not being used.

### func \(\*Stream\) RemoteAddr

```go
func (s *Stream) RemoteAddr() net.Addr
```

### func \(\*Stream\) Reset

```go
func (s *Stream) Reset() error
```

Reset sends a reset frame, putting the stream into the fully closed state.

### func \(\*Stream\) SendHeader

```go
func (s *Stream) SendHeader(headers http.Header, fin bool) error
```

SendHeader sends a header frame across the stream

### func \(\*Stream\) SendReply

```go
func (s *Stream) SendReply(headers http.Header, fin bool) error
```

SendReply sends a reply on a stream, only valid to be called once when handling a new stream

### func \(\*Stream\) SetDeadline

```go
func (s *Stream) SetDeadline(t time.Time) error
```

### func \(\*Stream\) SetPriority

```go
func (s *Stream) SetPriority(priority uint8)
```

SetPriority sets the stream priority, does not affect the remote priority of this stream after Open has been called. Valid values are 0 through 7, 0 being the highest priority and 7 the lowest.

### func \(\*Stream\) SetReadDeadline

```go
func (s *Stream) SetReadDeadline(t time.Time) error
```

### func \(\*Stream\) SetWriteDeadline

```go
func (s *Stream) SetWriteDeadline(t time.Time) error
```

### func \(\*Stream\) String

```go
func (s *Stream) String() string
```

String returns the string version of stream using the streamId to uniquely identify the stream

### func \(\*Stream\) Wait

```go
func (s *Stream) Wait() error
```

Wait waits for the stream to receive a reply.

### func \(\*Stream\) WaitTimeout

```go
func (s *Stream) WaitTimeout(timeout time.Duration) error
```

WaitTimeout waits for the stream to receive a reply or for timeout. When the timeout is reached, ErrTimeout will be returned.

### func \(\*Stream\) Write

```go
func (s *Stream) Write(data []byte) (n int, err error)
```

Write writes bytes to a stream, calling write data for each call.

### func \(\*Stream\) WriteData

```go
func (s *Stream) WriteData(data []byte, fin bool) error
```

WriteData writes data to stream, sending a dataframe per call

## type StreamHandler

```go
type StreamHandler func(stream *Stream)
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
