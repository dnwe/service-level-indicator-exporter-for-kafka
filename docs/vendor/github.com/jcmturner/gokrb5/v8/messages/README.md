<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# messages

```go
import "github.com/vmware/service-level-indicator-exporter-for-kafka/vendor/github.com/jcmturner/gokrb5/v8/messages"
```

Package messages implements Kerberos 5 message types and methods.

## Index

- [func MarshalTicketSequence(tkts []Ticket) (asn1.RawValue, error)](<#func-marshalticketsequence>)
- [type APRep](<#type-aprep>)
  - [func (a *APRep) Unmarshal(b []byte) error](<#func-aprep-unmarshal>)
- [type APReq](<#type-apreq>)
  - [func NewAPReq(tkt Ticket, sessionKey types.EncryptionKey, auth types.Authenticator) (APReq, error)](<#func-newapreq>)
  - [func (a *APReq) DecryptAuthenticator(sessionKey types.EncryptionKey) error](<#func-apreq-decryptauthenticator>)
  - [func (a *APReq) Marshal() ([]byte, error)](<#func-apreq-marshal>)
  - [func (a *APReq) Unmarshal(b []byte) error](<#func-apreq-unmarshal>)
  - [func (a *APReq) Verify(kt *keytab.Keytab, d time.Duration, cAddr types.HostAddress, snameOverride *types.PrincipalName) (bool, error)](<#func-apreq-verify>)
- [type ASRep](<#type-asrep>)
  - [func (k *ASRep) DecryptEncPart(c *credentials.Credentials) (types.EncryptionKey, error)](<#func-asrep-decryptencpart>)
  - [func (k *ASRep) Marshal() ([]byte, error)](<#func-asrep-marshal>)
  - [func (k *ASRep) Unmarshal(b []byte) error](<#func-asrep-unmarshal>)
  - [func (k *ASRep) Verify(cfg *config.Config, creds *credentials.Credentials, asReq ASReq) (bool, error)](<#func-asrep-verify>)
- [type ASReq](<#type-asreq>)
  - [func NewASReq(realm string, c *config.Config, cname, sname types.PrincipalName) (ASReq, error)](<#func-newasreq>)
  - [func NewASReqForChgPasswd(realm string, c *config.Config, cname types.PrincipalName) (ASReq, error)](<#func-newasreqforchgpasswd>)
  - [func NewASReqForTGT(realm string, c *config.Config, cname types.PrincipalName) (ASReq, error)](<#func-newasreqfortgt>)
  - [func (k *ASReq) Marshal() ([]byte, error)](<#func-asreq-marshal>)
  - [func (k *ASReq) Unmarshal(b []byte) error](<#func-asreq-unmarshal>)
- [type EncAPRepPart](<#type-encapreppart>)
  - [func (a *EncAPRepPart) Unmarshal(b []byte) error](<#func-encapreppart-unmarshal>)
- [type EncKDCRepPart](<#type-enckdcreppart>)
  - [func (e *EncKDCRepPart) Marshal() ([]byte, error)](<#func-enckdcreppart-marshal>)
  - [func (e *EncKDCRepPart) Unmarshal(b []byte) error](<#func-enckdcreppart-unmarshal>)
- [type EncKrbCredPart](<#type-enckrbcredpart>)
  - [func (k *EncKrbCredPart) Unmarshal(b []byte) error](<#func-enckrbcredpart-unmarshal>)
- [type EncKrbPrivPart](<#type-enckrbprivpart>)
  - [func (k *EncKrbPrivPart) Unmarshal(b []byte) error](<#func-enckrbprivpart-unmarshal>)
- [type EncTicketPart](<#type-encticketpart>)
  - [func (t *EncTicketPart) Unmarshal(b []byte) error](<#func-encticketpart-unmarshal>)
- [type KDCRepFields](<#type-kdcrepfields>)
- [type KDCReqBody](<#type-kdcreqbody>)
  - [func (k *KDCReqBody) Marshal() ([]byte, error)](<#func-kdcreqbody-marshal>)
  - [func (k *KDCReqBody) Unmarshal(b []byte) error](<#func-kdcreqbody-unmarshal>)
- [type KDCReqFields](<#type-kdcreqfields>)
- [type KRBCred](<#type-krbcred>)
  - [func (k *KRBCred) DecryptEncPart(key types.EncryptionKey) error](<#func-krbcred-decryptencpart>)
  - [func (k *KRBCred) Unmarshal(b []byte) error](<#func-krbcred-unmarshal>)
- [type KRBError](<#type-krberror>)
  - [func NewKRBError(sname types.PrincipalName, realm string, code int32, etext string) KRBError](<#func-newkrberror>)
  - [func (k KRBError) Error() string](<#func-krberror-error>)
  - [func (k *KRBError) Marshal() ([]byte, error)](<#func-krberror-marshal>)
  - [func (k *KRBError) Unmarshal(b []byte) error](<#func-krberror-unmarshal>)
- [type KRBPriv](<#type-krbpriv>)
  - [func NewKRBPriv(part EncKrbPrivPart) KRBPriv](<#func-newkrbpriv>)
  - [func (k *KRBPriv) DecryptEncPart(key types.EncryptionKey) error](<#func-krbpriv-decryptencpart>)
  - [func (k *KRBPriv) EncryptEncPart(key types.EncryptionKey) error](<#func-krbpriv-encryptencpart>)
  - [func (k *KRBPriv) Marshal() ([]byte, error)](<#func-krbpriv-marshal>)
  - [func (k *KRBPriv) Unmarshal(b []byte) error](<#func-krbpriv-unmarshal>)
- [type KRBSafe](<#type-krbsafe>)
  - [func (s *KRBSafe) Unmarshal(b []byte) error](<#func-krbsafe-unmarshal>)
- [type KRBSafeBody](<#type-krbsafebody>)
- [type KrbCredInfo](<#type-krbcredinfo>)
- [type LastReq](<#type-lastreq>)
- [type TGSRep](<#type-tgsrep>)
  - [func (k *TGSRep) DecryptEncPart(key types.EncryptionKey) error](<#func-tgsrep-decryptencpart>)
  - [func (k *TGSRep) Marshal() ([]byte, error)](<#func-tgsrep-marshal>)
  - [func (k *TGSRep) Unmarshal(b []byte) error](<#func-tgsrep-unmarshal>)
  - [func (k *TGSRep) Verify(cfg *config.Config, tgsReq TGSReq) (bool, error)](<#func-tgsrep-verify>)
- [type TGSReq](<#type-tgsreq>)
  - [func NewTGSReq(cname types.PrincipalName, kdcRealm string, c *config.Config, tgt Ticket, sessionKey types.EncryptionKey, sname types.PrincipalName, renewal bool) (TGSReq, error)](<#func-newtgsreq>)
  - [func NewUser2UserTGSReq(cname types.PrincipalName, kdcRealm string, c *config.Config, clientTGT Ticket, sessionKey types.EncryptionKey, sname types.PrincipalName, renewal bool, verifyingTGT Ticket) (TGSReq, error)](<#func-newuser2usertgsreq>)
  - [func (k *TGSReq) Marshal() ([]byte, error)](<#func-tgsreq-marshal>)
  - [func (k *TGSReq) Unmarshal(b []byte) error](<#func-tgsreq-unmarshal>)
- [type Ticket](<#type-ticket>)
  - [func NewTicket(cname types.PrincipalName, crealm string, sname types.PrincipalName, srealm string, flags asn1.BitString, sktab *keytab.Keytab, eTypeID int32, kvno int, authTime, startTime, endTime, renewTill time.Time) (Ticket, types.EncryptionKey, error)](<#func-newticket>)
  - [func (t *Ticket) Decrypt(key types.EncryptionKey) error](<#func-ticket-decrypt>)
  - [func (t *Ticket) DecryptEncPart(keytab *keytab.Keytab, sname *types.PrincipalName) error](<#func-ticket-decryptencpart>)
  - [func (t *Ticket) GetPACType(keytab *keytab.Keytab, sname *types.PrincipalName, l *log.Logger) (bool, pac.PACType, error)](<#func-ticket-getpactype>)
  - [func (t *Ticket) Marshal() ([]byte, error)](<#func-ticket-marshal>)
  - [func (t *Ticket) Unmarshal(b []byte) error](<#func-ticket-unmarshal>)
  - [func (t *Ticket) Valid(d time.Duration) (bool, error)](<#func-ticket-valid>)
- [type TransitedEncoding](<#type-transitedencoding>)


## func MarshalTicketSequence

```go
func MarshalTicketSequence(tkts []Ticket) (asn1.RawValue, error)
```

MarshalTicketSequence marshals a slice of Tickets returning an ASN1 raw value containing the ticket sequence.

## type APRep

APRep implements RFC 4120 KRB\_AP\_REP: https://tools.ietf.org/html/rfc4120#section-5.5.2.

```go
type APRep struct {
    PVNO    int                 `asn1:"explicit,tag:0"`
    MsgType int                 `asn1:"explicit,tag:1"`
    EncPart types.EncryptedData `asn1:"explicit,tag:2"`
}
```

### func \(\*APRep\) Unmarshal

```go
func (a *APRep) Unmarshal(b []byte) error
```

Unmarshal bytes b into the APRep struct.

## type APReq

APReq implements RFC 4120 KRB\_AP\_REQ: https://tools.ietf.org/html/rfc4120#section-5.5.1.

```go
type APReq struct {
    PVNO                   int                 `asn1:"explicit,tag:0"`
    MsgType                int                 `asn1:"explicit,tag:1"`
    APOptions              asn1.BitString      `asn1:"explicit,tag:2"`
    Ticket                 Ticket              `asn1:"explicit,tag:3"`
    EncryptedAuthenticator types.EncryptedData `asn1:"explicit,tag:4"`
    Authenticator          types.Authenticator `asn1:"optional"`
}
```

### func NewAPReq

```go
func NewAPReq(tkt Ticket, sessionKey types.EncryptionKey, auth types.Authenticator) (APReq, error)
```

NewAPReq generates a new KRB\_AP\_REQ struct.

### func \(\*APReq\) DecryptAuthenticator

```go
func (a *APReq) DecryptAuthenticator(sessionKey types.EncryptionKey) error
```

DecryptAuthenticator decrypts the Authenticator within the AP\_REQ. sessionKey may simply be the key within the decrypted EncPart of the ticket within the AP\_REQ.

### func \(\*APReq\) Marshal

```go
func (a *APReq) Marshal() ([]byte, error)
```

Marshal APReq struct.

### func \(\*APReq\) Unmarshal

```go
func (a *APReq) Unmarshal(b []byte) error
```

Unmarshal bytes b into the APReq struct.

### func \(\*APReq\) Verify

```go
func (a *APReq) Verify(kt *keytab.Keytab, d time.Duration, cAddr types.HostAddress, snameOverride *types.PrincipalName) (bool, error)
```

Verify an AP\_REQ using service's keytab, spn and max acceptable clock skew duration. The service ticket encrypted part and authenticator will be decrypted as part of this operation.

## type ASRep

ASRep implements RFC 4120 KRB\_AS\_REP: https://tools.ietf.org/html/rfc4120#section-5.4.2.

```go
type ASRep struct {
    KDCRepFields
}
```

### func \(\*ASRep\) DecryptEncPart

```go
func (k *ASRep) DecryptEncPart(c *credentials.Credentials) (types.EncryptionKey, error)
```

DecryptEncPart decrypts the encrypted part of an AS\_REP.

### func \(\*ASRep\) Marshal

```go
func (k *ASRep) Marshal() ([]byte, error)
```

Marshal ASRep struct.

### func \(\*ASRep\) Unmarshal

```go
func (k *ASRep) Unmarshal(b []byte) error
```

Unmarshal bytes b into the ASRep struct.

### func \(\*ASRep\) Verify

```go
func (k *ASRep) Verify(cfg *config.Config, creds *credentials.Credentials, asReq ASReq) (bool, error)
```

Verify checks the validity of AS\_REP message.

## type ASReq

ASReq implements RFC 4120 KRB\_AS\_REQ: https://tools.ietf.org/html/rfc4120#section-5.4.1.

```go
type ASReq struct {
    KDCReqFields
}
```

### func NewASReq

```go
func NewASReq(realm string, c *config.Config, cname, sname types.PrincipalName) (ASReq, error)
```

NewASReq generates a new KRB\_AS\_REQ struct for a given SNAME.

### func NewASReqForChgPasswd

```go
func NewASReqForChgPasswd(realm string, c *config.Config, cname types.PrincipalName) (ASReq, error)
```

NewASReqForChgPasswd generates a new KRB\_AS\_REQ struct for a change password request.

### func NewASReqForTGT

```go
func NewASReqForTGT(realm string, c *config.Config, cname types.PrincipalName) (ASReq, error)
```

NewASReqForTGT generates a new KRB\_AS\_REQ struct for a TGT request.

### func \(\*ASReq\) Marshal

```go
func (k *ASReq) Marshal() ([]byte, error)
```

Marshal ASReq struct.

### func \(\*ASReq\) Unmarshal

```go
func (k *ASReq) Unmarshal(b []byte) error
```

Unmarshal bytes b into the ASReq struct.

## type EncAPRepPart

EncAPRepPart is the encrypted part of KRB\_AP\_REP.

```go
type EncAPRepPart struct {
    CTime          time.Time           `asn1:"generalized,explicit,tag:0"`
    Cusec          int                 `asn1:"explicit,tag:1"`
    Subkey         types.EncryptionKey `asn1:"optional,explicit,tag:2"`
    SequenceNumber int64               `asn1:"optional,explicit,tag:3"`
}
```

### func \(\*EncAPRepPart\) Unmarshal

```go
func (a *EncAPRepPart) Unmarshal(b []byte) error
```

Unmarshal bytes b into the APRep encrypted part struct.

## type EncKDCRepPart

EncKDCRepPart is the encrypted part of KRB\_KDC\_REP.

```go
type EncKDCRepPart struct {
    Key           types.EncryptionKey  `asn1:"explicit,tag:0"`
    LastReqs      []LastReq            `asn1:"explicit,tag:1"`
    Nonce         int                  `asn1:"explicit,tag:2"`
    KeyExpiration time.Time            `asn1:"generalized,explicit,optional,tag:3"`
    Flags         asn1.BitString       `asn1:"explicit,tag:4"`
    AuthTime      time.Time            `asn1:"generalized,explicit,tag:5"`
    StartTime     time.Time            `asn1:"generalized,explicit,optional,tag:6"`
    EndTime       time.Time            `asn1:"generalized,explicit,tag:7"`
    RenewTill     time.Time            `asn1:"generalized,explicit,optional,tag:8"`
    SRealm        string               `asn1:"generalstring,explicit,tag:9"`
    SName         types.PrincipalName  `asn1:"explicit,tag:10"`
    CAddr         []types.HostAddress  `asn1:"explicit,optional,tag:11"`
    EncPAData     types.PADataSequence `asn1:"explicit,optional,tag:12"`
}
```

### func \(\*EncKDCRepPart\) Marshal

```go
func (e *EncKDCRepPart) Marshal() ([]byte, error)
```

Marshal encrypted part of KRB\_KDC\_REP.

### func \(\*EncKDCRepPart\) Unmarshal

```go
func (e *EncKDCRepPart) Unmarshal(b []byte) error
```

Unmarshal bytes b into encrypted part of KRB\_KDC\_REP.

## type EncKrbCredPart

EncKrbCredPart is the encrypted part of KRB\_CRED.

```go
type EncKrbCredPart struct {
    TicketInfo []KrbCredInfo     `asn1:"explicit,tag:0"`
    Nouce      int               `asn1:"optional,explicit,tag:1"`
    Timestamp  time.Time         `asn1:"generalized,optional,explicit,tag:2"`
    Usec       int               `asn1:"optional,explicit,tag:3"`
    SAddress   types.HostAddress `asn1:"optional,explicit,tag:4"`
    RAddress   types.HostAddress `asn1:"optional,explicit,tag:5"`
}
```

### func \(\*EncKrbCredPart\) Unmarshal

```go
func (k *EncKrbCredPart) Unmarshal(b []byte) error
```

Unmarshal bytes b into the encrypted part of KRB\_CRED.

## type EncKrbPrivPart

EncKrbPrivPart is the encrypted part of KRB\_PRIV.

```go
type EncKrbPrivPart struct {
    UserData       []byte            `asn1:"explicit,tag:0"`
    Timestamp      time.Time         `asn1:"generalized,optional,explicit,tag:1"`
    Usec           int               `asn1:"optional,explicit,tag:2"`
    SequenceNumber int64             `asn1:"optional,explicit,tag:3"`
    SAddress       types.HostAddress `asn1:"explicit,tag:4"`
    RAddress       types.HostAddress `asn1:"optional,explicit,tag:5"`
}
```

### func \(\*EncKrbPrivPart\) Unmarshal

```go
func (k *EncKrbPrivPart) Unmarshal(b []byte) error
```

Unmarshal bytes b into the EncKrbPrivPart struct.

## type EncTicketPart

EncTicketPart is the encrypted part of the Ticket.

```go
type EncTicketPart struct {
    Flags             asn1.BitString          `asn1:"explicit,tag:0"`
    Key               types.EncryptionKey     `asn1:"explicit,tag:1"`
    CRealm            string                  `asn1:"generalstring,explicit,tag:2"`
    CName             types.PrincipalName     `asn1:"explicit,tag:3"`
    Transited         TransitedEncoding       `asn1:"explicit,tag:4"`
    AuthTime          time.Time               `asn1:"generalized,explicit,tag:5"`
    StartTime         time.Time               `asn1:"generalized,explicit,optional,tag:6"`
    EndTime           time.Time               `asn1:"generalized,explicit,tag:7"`
    RenewTill         time.Time               `asn1:"generalized,explicit,optional,tag:8"`
    CAddr             types.HostAddresses     `asn1:"explicit,optional,tag:9"`
    AuthorizationData types.AuthorizationData `asn1:"explicit,optional,tag:10"`
}
```

### func \(\*EncTicketPart\) Unmarshal

```go
func (t *EncTicketPart) Unmarshal(b []byte) error
```

Unmarshal bytes b into the EncTicketPart struct.

## type KDCRepFields

KDCRepFields represents the KRB\_KDC\_REP fields.

```go
type KDCRepFields struct {
    PVNO             int
    MsgType          int
    PAData           []types.PAData
    CRealm           string
    CName            types.PrincipalName
    Ticket           Ticket
    EncPart          types.EncryptedData
    DecryptedEncPart EncKDCRepPart
}
```

## type KDCReqBody

KDCReqBody implements the KRB\_KDC\_REQ request body.

```go
type KDCReqBody struct {
    KDCOptions        asn1.BitString      `asn1:"explicit,tag:0"`
    CName             types.PrincipalName `asn1:"explicit,optional,tag:1"`
    Realm             string              `asn1:"generalstring,explicit,tag:2"`
    SName             types.PrincipalName `asn1:"explicit,optional,tag:3"`
    From              time.Time           `asn1:"generalized,explicit,optional,tag:4"`
    Till              time.Time           `asn1:"generalized,explicit,tag:5"`
    RTime             time.Time           `asn1:"generalized,explicit,optional,tag:6"`
    Nonce             int                 `asn1:"explicit,tag:7"`
    EType             []int32             `asn1:"explicit,tag:8"`
    Addresses         []types.HostAddress `asn1:"explicit,optional,tag:9"`
    EncAuthData       types.EncryptedData `asn1:"explicit,optional,tag:10"`
    AdditionalTickets []Ticket            `asn1:"explicit,optional,tag:11"`
}
```

### func \(\*KDCReqBody\) Marshal

```go
func (k *KDCReqBody) Marshal() ([]byte, error)
```

Marshal KRB\_KDC\_REQ body struct.

### func \(\*KDCReqBody\) Unmarshal

```go
func (k *KDCReqBody) Unmarshal(b []byte) error
```

Unmarshal bytes b into the KRB\_KDC\_REQ body struct.

## type KDCReqFields

KDCReqFields represents the KRB\_KDC\_REQ fields.

```go
type KDCReqFields struct {
    PVNO    int
    MsgType int
    PAData  types.PADataSequence
    ReqBody KDCReqBody
    Renewal bool
}
```

## type KRBCred

KRBCred implements RFC 4120 KRB\_CRED: https://tools.ietf.org/html/rfc4120#section-5.8.1.

```go
type KRBCred struct {
    PVNO             int
    MsgType          int
    Tickets          []Ticket
    EncPart          types.EncryptedData
    DecryptedEncPart EncKrbCredPart
}
```

### func \(\*KRBCred\) DecryptEncPart

```go
func (k *KRBCred) DecryptEncPart(key types.EncryptionKey) error
```

DecryptEncPart decrypts the encrypted part of a KRB\_CRED.

### func \(\*KRBCred\) Unmarshal

```go
func (k *KRBCred) Unmarshal(b []byte) error
```

Unmarshal bytes b into the KRBCred struct.

## type KRBError

KRBError implements RFC 4120 KRB\_ERROR: https://tools.ietf.org/html/rfc4120#section-5.9.1.

```go
type KRBError struct {
    PVNO      int                 `asn1:"explicit,tag:0"`
    MsgType   int                 `asn1:"explicit,tag:1"`
    CTime     time.Time           `asn1:"generalized,optional,explicit,tag:2"`
    Cusec     int                 `asn1:"optional,explicit,tag:3"`
    STime     time.Time           `asn1:"generalized,explicit,tag:4"`
    Susec     int                 `asn1:"explicit,tag:5"`
    ErrorCode int32               `asn1:"explicit,tag:6"`
    CRealm    string              `asn1:"generalstring,optional,explicit,tag:7"`
    CName     types.PrincipalName `asn1:"optional,explicit,tag:8"`
    Realm     string              `asn1:"generalstring,explicit,tag:9"`
    SName     types.PrincipalName `asn1:"explicit,tag:10"`
    EText     string              `asn1:"generalstring,optional,explicit,tag:11"`
    EData     []byte              `asn1:"optional,explicit,tag:12"`
}
```

### func NewKRBError

```go
func NewKRBError(sname types.PrincipalName, realm string, code int32, etext string) KRBError
```

NewKRBError creates a new KRBError.

### func \(KRBError\) Error

```go
func (k KRBError) Error() string
```

Error method implementing error interface on KRBError struct.

### func \(\*KRBError\) Marshal

```go
func (k *KRBError) Marshal() ([]byte, error)
```

Marshal a KRBError into bytes.

### func \(\*KRBError\) Unmarshal

```go
func (k *KRBError) Unmarshal(b []byte) error
```

Unmarshal bytes b into the KRBError struct.

## type KRBPriv

KRBPriv implements RFC 4120 type: https://tools.ietf.org/html/rfc4120#section-5.7.1.

```go
type KRBPriv struct {
    PVNO             int                 `asn1:"explicit,tag:0"`
    MsgType          int                 `asn1:"explicit,tag:1"`
    EncPart          types.EncryptedData `asn1:"explicit,tag:3"`
    DecryptedEncPart EncKrbPrivPart      `asn1:"optional,omitempty"` // Not part of ASN1 bytes so marked as optional so unmarshalling works
}
```

### func NewKRBPriv

```go
func NewKRBPriv(part EncKrbPrivPart) KRBPriv
```

NewKRBPriv returns a new KRBPriv type.

### func \(\*KRBPriv\) DecryptEncPart

```go
func (k *KRBPriv) DecryptEncPart(key types.EncryptionKey) error
```

DecryptEncPart decrypts the encrypted part of the KRBPriv message.

### func \(\*KRBPriv\) EncryptEncPart

```go
func (k *KRBPriv) EncryptEncPart(key types.EncryptionKey) error
```

EncryptEncPart encrypts the DecryptedEncPart within the KRBPriv. Use to prepare for marshaling.

### func \(\*KRBPriv\) Marshal

```go
func (k *KRBPriv) Marshal() ([]byte, error)
```

Marshal the KRBPriv.

### func \(\*KRBPriv\) Unmarshal

```go
func (k *KRBPriv) Unmarshal(b []byte) error
```

Unmarshal bytes b into the KRBPriv struct.

## type KRBSafe

KRBSafe implements RFC 4120 KRB\_SAFE: https://tools.ietf.org/html/rfc4120#section-5.6.1.

```go
type KRBSafe struct {
    PVNO     int            `asn1:"explicit,tag:0"`
    MsgType  int            `asn1:"explicit,tag:1"`
    SafeBody KRBSafeBody    `asn1:"explicit,tag:2"`
    Cksum    types.Checksum `asn1:"explicit,tag:3"`
}
```

### func \(\*KRBSafe\) Unmarshal

```go
func (s *KRBSafe) Unmarshal(b []byte) error
```

Unmarshal bytes b into the KRBSafe struct.

## type KRBSafeBody

KRBSafeBody implements the KRB\_SAFE\_BODY of KRB\_SAFE.

```go
type KRBSafeBody struct {
    UserData       []byte            `asn1:"explicit,tag:0"`
    Timestamp      time.Time         `asn1:"generalized,optional,explicit,tag:1"`
    Usec           int               `asn1:"optional,explicit,tag:2"`
    SequenceNumber int64             `asn1:"optional,explicit,tag:3"`
    SAddress       types.HostAddress `asn1:"explicit,tag:4"`
    RAddress       types.HostAddress `asn1:"optional,explicit,tag:5"`
}
```

## type KrbCredInfo

KrbCredInfo is the KRB\_CRED\_INFO part of KRB\_CRED.

```go
type KrbCredInfo struct {
    Key       types.EncryptionKey `asn1:"explicit,tag:0"`
    PRealm    string              `asn1:"generalstring,optional,explicit,tag:1"`
    PName     types.PrincipalName `asn1:"optional,explicit,tag:2"`
    Flags     asn1.BitString      `asn1:"optional,explicit,tag:3"`
    AuthTime  time.Time           `asn1:"generalized,optional,explicit,tag:4"`
    StartTime time.Time           `asn1:"generalized,optional,explicit,tag:5"`
    EndTime   time.Time           `asn1:"generalized,optional,explicit,tag:6"`
    RenewTill time.Time           `asn1:"generalized,optional,explicit,tag:7"`
    SRealm    string              `asn1:"optional,explicit,ia5,tag:8"`
    SName     types.PrincipalName `asn1:"optional,explicit,tag:9"`
    CAddr     types.HostAddresses `asn1:"optional,explicit,tag:10"`
}
```

## type LastReq

LastReq part of KRB\_KDC\_REP.

```go
type LastReq struct {
    LRType  int32     `asn1:"explicit,tag:0"`
    LRValue time.Time `asn1:"generalized,explicit,tag:1"`
}
```

## type TGSRep

TGSRep implements RFC 4120 KRB\_TGS\_REP: https://tools.ietf.org/html/rfc4120#section-5.4.2.

```go
type TGSRep struct {
    KDCRepFields
}
```

### func \(\*TGSRep\) DecryptEncPart

```go
func (k *TGSRep) DecryptEncPart(key types.EncryptionKey) error
```

DecryptEncPart decrypts the encrypted part of an TGS\_REP.

### func \(\*TGSRep\) Marshal

```go
func (k *TGSRep) Marshal() ([]byte, error)
```

Marshal TGSRep struct.

### func \(\*TGSRep\) Unmarshal

```go
func (k *TGSRep) Unmarshal(b []byte) error
```

Unmarshal bytes b into the TGSRep struct.

### func \(\*TGSRep\) Verify

```go
func (k *TGSRep) Verify(cfg *config.Config, tgsReq TGSReq) (bool, error)
```

Verify checks the validity of the TGS\_REP message.

## type TGSReq

TGSReq implements RFC 4120 KRB\_TGS\_REQ: https://tools.ietf.org/html/rfc4120#section-5.4.1.

```go
type TGSReq struct {
    KDCReqFields
}
```

### func NewTGSReq

```go
func NewTGSReq(cname types.PrincipalName, kdcRealm string, c *config.Config, tgt Ticket, sessionKey types.EncryptionKey, sname types.PrincipalName, renewal bool) (TGSReq, error)
```

NewTGSReq generates a new KRB\_TGS\_REQ struct.

### func NewUser2UserTGSReq

```go
func NewUser2UserTGSReq(cname types.PrincipalName, kdcRealm string, c *config.Config, clientTGT Ticket, sessionKey types.EncryptionKey, sname types.PrincipalName, renewal bool, verifyingTGT Ticket) (TGSReq, error)
```

NewUser2UserTGSReq returns a TGS\-REQ suitable for user\-to\-user authentication \(https://tools.ietf.org/html/rfc4120#section-3.7\)

### func \(\*TGSReq\) Marshal

```go
func (k *TGSReq) Marshal() ([]byte, error)
```

Marshal TGSReq struct.

### func \(\*TGSReq\) Unmarshal

```go
func (k *TGSReq) Unmarshal(b []byte) error
```

Unmarshal bytes b into the TGSReq struct.

## type Ticket

Ticket implements the Kerberos ticket.

```go
type Ticket struct {
    TktVNO           int                 `asn1:"explicit,tag:0"`
    Realm            string              `asn1:"generalstring,explicit,tag:1"`
    SName            types.PrincipalName `asn1:"explicit,tag:2"`
    EncPart          types.EncryptedData `asn1:"explicit,tag:3"`
    DecryptedEncPart EncTicketPart       `asn1:"optional"` // Not part of ASN1 bytes so marked as optional so unmarshalling works
}
```

### func NewTicket

```go
func NewTicket(cname types.PrincipalName, crealm string, sname types.PrincipalName, srealm string, flags asn1.BitString, sktab *keytab.Keytab, eTypeID int32, kvno int, authTime, startTime, endTime, renewTill time.Time) (Ticket, types.EncryptionKey, error)
```

NewTicket creates a new Ticket instance.

### func \(\*Ticket\) Decrypt

```go
func (t *Ticket) Decrypt(key types.EncryptionKey) error
```

Decrypt decrypts the encrypted part of the ticket using the key provided.

### func \(\*Ticket\) DecryptEncPart

```go
func (t *Ticket) DecryptEncPart(keytab *keytab.Keytab, sname *types.PrincipalName) error
```

DecryptEncPart decrypts the encrypted part of the ticket. The sname argument can be used to specify which service principal's key should be used to decrypt the ticket. If nil is passed as the sname then the service principal specified within the ticket it used.

### func \(\*Ticket\) GetPACType

```go
func (t *Ticket) GetPACType(keytab *keytab.Keytab, sname *types.PrincipalName, l *log.Logger) (bool, pac.PACType, error)
```

GetPACType returns a Microsoft PAC that has been extracted from the ticket and processed.

### func \(\*Ticket\) Marshal

```go
func (t *Ticket) Marshal() ([]byte, error)
```

Marshal the Ticket.

### func \(\*Ticket\) Unmarshal

```go
func (t *Ticket) Unmarshal(b []byte) error
```

Unmarshal bytes b into a Ticket struct.

### func \(\*Ticket\) Valid

```go
func (t *Ticket) Valid(d time.Duration) (bool, error)
```

Valid checks it the ticket is currently valid. Max duration passed endtime passed in as argument.

## type TransitedEncoding

TransitedEncoding part of the ticket's encrypted part.

```go
type TransitedEncoding struct {
    TRType   int32  `asn1:"explicit,tag:0"`
    Contents []byte `asn1:"explicit,tag:1"`
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
