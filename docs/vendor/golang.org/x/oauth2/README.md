<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# oauth2

```go
import "golang.org/x/oauth2"
```

Package oauth2 provides support for making OAuth2 authorized and authenticated HTTP requests, as specified in RFC 6749. It can additionally grant authorization with Bearer JWT.

## Index

- [Variables](<#variables>)
- [func NewClient(ctx context.Context, src TokenSource) *http.Client](<#func-newclient>)
- [func RegisterBrokenAuthHeaderProvider(tokenURL string)](<#func-registerbrokenauthheaderprovider>)
- [type AuthCodeOption](<#type-authcodeoption>)
  - [func SetAuthURLParam(key, value string) AuthCodeOption](<#func-setauthurlparam>)
- [type AuthStyle](<#type-authstyle>)
- [type Config](<#type-config>)
  - [func (c *Config) AuthCodeURL(state string, opts ...AuthCodeOption) string](<#func-config-authcodeurl>)
  - [func (c *Config) Client(ctx context.Context, t *Token) *http.Client](<#func-config-client>)
  - [func (c *Config) Exchange(ctx context.Context, code string, opts ...AuthCodeOption) (*Token, error)](<#func-config-exchange>)
  - [func (c *Config) PasswordCredentialsToken(ctx context.Context, username, password string) (*Token, error)](<#func-config-passwordcredentialstoken>)
  - [func (c *Config) TokenSource(ctx context.Context, t *Token) TokenSource](<#func-config-tokensource>)
- [type Endpoint](<#type-endpoint>)
- [type RetrieveError](<#type-retrieveerror>)
  - [func (r *RetrieveError) Error() string](<#func-retrieveerror-error>)
- [type Token](<#type-token>)
  - [func (t *Token) Extra(key string) interface{}](<#func-token-extra>)
  - [func (t *Token) SetAuthHeader(r *http.Request)](<#func-token-setauthheader>)
  - [func (t *Token) Type() string](<#func-token-type>)
  - [func (t *Token) Valid() bool](<#func-token-valid>)
  - [func (t *Token) WithExtra(extra interface{}) *Token](<#func-token-withextra>)
- [type TokenSource](<#type-tokensource>)
  - [func ReuseTokenSource(t *Token, src TokenSource) TokenSource](<#func-reusetokensource>)
  - [func StaticTokenSource(t *Token) TokenSource](<#func-statictokensource>)
- [type Transport](<#type-transport>)
  - [func (t *Transport) CancelRequest(req *http.Request)](<#func-transport-cancelrequest>)
  - [func (t *Transport) RoundTrip(req *http.Request) (*http.Response, error)](<#func-transport-roundtrip>)


## Variables

HTTPClient is the context key to use with golang.org/x/net/context's WithValue function to associate an \*http.Client value with a context.

```go
var HTTPClient internal.ContextKey
```

NoContext is the default context you should supply if not using your own context.Context \(see https://golang.org/x/net/context\).

Deprecated: Use context.Background\(\) or context.TODO\(\) instead.

```go
var NoContext = context.TODO()
```

## func NewClient

```go
func NewClient(ctx context.Context, src TokenSource) *http.Client
```

NewClient creates an \*http.Client from a Context and TokenSource. The returned client is not valid beyond the lifetime of the context.

Note that if a custom \*http.Client is provided via the Context it is used only for token acquisition and is not used to configure the \*http.Client returned from NewClient.

As a special case, if src is nil, a non\-OAuth2 client is returned using the provided context. This exists to support related OAuth2 packages.

## func RegisterBrokenAuthHeaderProvider

```go
func RegisterBrokenAuthHeaderProvider(tokenURL string)
```

RegisterBrokenAuthHeaderProvider previously did something. It is now a no\-op.

Deprecated: this function no longer does anything. Caller code that wants to avoid potential extra HTTP requests made during auto\-probing of the provider's auth style should set Endpoint.AuthStyle.

## type AuthCodeOption

An AuthCodeOption is passed to Config.AuthCodeURL.

```go
type AuthCodeOption interface {
    // contains filtered or unexported methods
}
```

```go
var (
    // AccessTypeOnline and AccessTypeOffline are options passed
    // to the Options.AuthCodeURL method. They modify the
    // "access_type" field that gets sent in the URL returned by
    // AuthCodeURL.
    //
    // Online is the default if neither is specified. If your
    // application needs to refresh access tokens when the user
    // is not present at the browser, then use offline. This will
    // result in your application obtaining a refresh token the
    // first time your application exchanges an authorization
    // code for a user.
    AccessTypeOnline  AuthCodeOption = SetAuthURLParam("access_type", "online")
    AccessTypeOffline AuthCodeOption = SetAuthURLParam("access_type", "offline")

    // ApprovalForce forces the users to view the consent dialog
    // and confirm the permissions request at the URL returned
    // from AuthCodeURL, even if they've already done so.
    ApprovalForce AuthCodeOption = SetAuthURLParam("prompt", "consent")
)
```

### func SetAuthURLParam

```go
func SetAuthURLParam(key, value string) AuthCodeOption
```

SetAuthURLParam builds an AuthCodeOption which passes key/value parameters to a provider's authorization endpoint.

## type AuthStyle

AuthStyle represents how requests for tokens are authenticated to the server.

```go
type AuthStyle int
```

```go
const (
    // AuthStyleAutoDetect means to auto-detect which authentication
    // style the provider wants by trying both ways and caching
    // the successful way for the future.
    AuthStyleAutoDetect AuthStyle = 0

    // AuthStyleInParams sends the "client_id" and "client_secret"
    // in the POST body as application/x-www-form-urlencoded parameters.
    AuthStyleInParams AuthStyle = 1

    // AuthStyleInHeader sends the client_id and client_password
    // using HTTP Basic Authorization. This is an optional style
    // described in the OAuth2 RFC 6749 section 2.3.1.
    AuthStyleInHeader AuthStyle = 2
)
```

## type Config

Config describes a typical 3\-legged OAuth2 flow, with both the client application information and the server's endpoint URLs. For the client credentials 2\-legged OAuth2 flow, see the clientcredentials package \(https://golang.org/x/oauth2/clientcredentials\).

```go
type Config struct {
    // ClientID is the application's ID.
    ClientID string

    // ClientSecret is the application's secret.
    ClientSecret string

    // Endpoint contains the resource server's token endpoint
    // URLs. These are constants specific to each server and are
    // often available via site-specific packages, such as
    // google.Endpoint or github.Endpoint.
    Endpoint Endpoint

    // RedirectURL is the URL to redirect users going through
    // the OAuth flow, after the resource owner's URLs.
    RedirectURL string

    // Scope specifies optional requested permissions.
    Scopes []string
}
```

### func \(\*Config\) AuthCodeURL

```go
func (c *Config) AuthCodeURL(state string, opts ...AuthCodeOption) string
```

AuthCodeURL returns a URL to OAuth 2.0 provider's consent page that asks for permissions for the required scopes explicitly.

State is a token to protect the user from CSRF attacks. You must always provide a non\-empty string and validate that it matches the the state query parameter on your redirect callback. See http://tools.ietf.org/html/rfc6749#section-10.12 for more info.

Opts may include AccessTypeOnline or AccessTypeOffline, as well as ApprovalForce. It can also be used to pass the PKCE challenge. See https://www.oauth.com/oauth2-servers/pkce/ for more info.

### func \(\*Config\) Client

```go
func (c *Config) Client(ctx context.Context, t *Token) *http.Client
```

Client returns an HTTP client using the provided token. The token will auto\-refresh as necessary. The underlying HTTP transport will be obtained using the provided context. The returned client and its Transport should not be modified.

### func \(\*Config\) Exchange

```go
func (c *Config) Exchange(ctx context.Context, code string, opts ...AuthCodeOption) (*Token, error)
```

Exchange converts an authorization code into a token.

It is used after a resource provider redirects the user back to the Redirect URI \(the URL obtained from AuthCodeURL\).

The provided context optionally controls which HTTP client is used. See the HTTPClient variable.

The code will be in the \*http.Request.FormValue\("code"\). Before calling Exchange, be sure to validate FormValue\("state"\).

Opts may include the PKCE verifier code if previously used in AuthCodeURL. See https://www.oauth.com/oauth2-servers/pkce/ for more info.

### func \(\*Config\) PasswordCredentialsToken

```go
func (c *Config) PasswordCredentialsToken(ctx context.Context, username, password string) (*Token, error)
```

PasswordCredentialsToken converts a resource owner username and password pair into a token.

Per the RFC, this grant type should only be used "when there is a high degree of trust between the resource owner and the client \(e.g., the client is part of the device operating system or a highly privileged application\), and when other authorization grant types are not available." See https://tools.ietf.org/html/rfc6749#section-4.3 for more info.

The provided context optionally controls which HTTP client is used. See the HTTPClient variable.

### func \(\*Config\) TokenSource

```go
func (c *Config) TokenSource(ctx context.Context, t *Token) TokenSource
```

TokenSource returns a TokenSource that returns t until t expires, automatically refreshing it as necessary using the provided context.

Most users will use Config.Client instead.

## type Endpoint

Endpoint represents an OAuth 2.0 provider's authorization and token endpoint URLs.

```go
type Endpoint struct {
    AuthURL  string
    TokenURL string

    // AuthStyle optionally specifies how the endpoint wants the
    // client ID & client secret sent. The zero value means to
    // auto-detect.
    AuthStyle AuthStyle
}
```

## type RetrieveError

RetrieveError is the error returned when the token endpoint returns a non\-2XX HTTP status code.

```go
type RetrieveError struct {
    Response *http.Response
    // Body is the body that was consumed by reading Response.Body.
    // It may be truncated.
    Body []byte
}
```

### func \(\*RetrieveError\) Error

```go
func (r *RetrieveError) Error() string
```

## type Token

Token represents the credentials used to authorize the requests to access protected resources on the OAuth 2.0 provider's backend.

Most users of this package should not access fields of Token directly. They're exported mostly for use by related packages implementing derivative OAuth2 flows.

```go
type Token struct {
    // AccessToken is the token that authorizes and authenticates
    // the requests.
    AccessToken string `json:"access_token"`

    // TokenType is the type of token.
    // The Type method returns either this or "Bearer", the default.
    TokenType string `json:"token_type,omitempty"`

    // RefreshToken is a token that's used by the application
    // (as opposed to the user) to refresh the access token
    // if it expires.
    RefreshToken string `json:"refresh_token,omitempty"`

    // Expiry is the optional expiration time of the access token.
    //
    // If zero, TokenSource implementations will reuse the same
    // token forever and RefreshToken or equivalent
    // mechanisms for that TokenSource will not be used.
    Expiry time.Time `json:"expiry,omitempty"`
    // contains filtered or unexported fields
}
```

### func \(\*Token\) Extra

```go
func (t *Token) Extra(key string) interface{}
```

Extra returns an extra field. Extra fields are key\-value pairs returned by the server as a part of the token retrieval response.

### func \(\*Token\) SetAuthHeader

```go
func (t *Token) SetAuthHeader(r *http.Request)
```

SetAuthHeader sets the Authorization header to r using the access token in t.

This method is unnecessary when using Transport or an HTTP Client returned by this package.

### func \(\*Token\) Type

```go
func (t *Token) Type() string
```

Type returns t.TokenType if non\-empty, else "Bearer".

### func \(\*Token\) Valid

```go
func (t *Token) Valid() bool
```

Valid reports whether t is non\-nil, has an AccessToken, and is not expired.

### func \(\*Token\) WithExtra

```go
func (t *Token) WithExtra(extra interface{}) *Token
```

WithExtra returns a new Token that's a clone of t, but using the provided raw extra map. This is only intended for use by packages implementing derivative OAuth2 flows.

## type TokenSource

A TokenSource is anything that can return a token.

```go
type TokenSource interface {
    // Token returns a token or an error.
    // Token must be safe for concurrent use by multiple goroutines.
    // The returned Token must not be modified.
    Token() (*Token, error)
}
```

### func ReuseTokenSource

```go
func ReuseTokenSource(t *Token, src TokenSource) TokenSource
```

ReuseTokenSource returns a TokenSource which repeatedly returns the same token as long as it's valid, starting with t. When its cached token is invalid, a new token is obtained from src.

ReuseTokenSource is typically used to reuse tokens from a cache \(such as a file on disk\) between runs of a program, rather than obtaining new tokens unnecessarily.

The initial token t may be nil, in which case the TokenSource is wrapped in a caching version if it isn't one already. This also means it's always safe to wrap ReuseTokenSource around any other TokenSource without adverse effects.

### func StaticTokenSource

```go
func StaticTokenSource(t *Token) TokenSource
```

StaticTokenSource returns a TokenSource that always returns the same token. Because the provided token t is never refreshed, StaticTokenSource is only useful for tokens that never expire.

## type Transport

Transport is an http.RoundTripper that makes OAuth 2.0 HTTP requests, wrapping a base RoundTripper and adding an Authorization header with a token from the supplied Sources.

Transport is a low\-level mechanism. Most code will use the higher\-level Config.Client method instead.

```go
type Transport struct {
    // Source supplies the token to add to outgoing requests'
    // Authorization headers.
    Source TokenSource

    // Base is the base RoundTripper used to make HTTP requests.
    // If nil, http.DefaultTransport is used.
    Base http.RoundTripper
}
```

### func \(\*Transport\) CancelRequest

```go
func (t *Transport) CancelRequest(req *http.Request)
```

CancelRequest does nothing. It used to be a legacy cancellation mechanism but now only it only logs on first use to warn that it's deprecated.

Deprecated: use contexts for cancellation instead.

### func \(\*Transport\) RoundTrip

```go
func (t *Transport) RoundTrip(req *http.Request) (*http.Response, error)
```

RoundTrip authorizes and authenticates the request with an access token from Transport's Source.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
